<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        img {
            border: 1px solid #ddd;
            /* Gray border */
            border-radius: 4px;
            /* Rounded border */
            padding: 5px;
            /* Some padding */
            width: 150px;
            /* Set a small width */
        }

        /* Add a hover effect (blue shadow) */
        img:hover {
            box-shadow: 0 0 2px 1px rgba(0, 140, 186, 0.5);
        }
        .imageBook{
            width: 10vw;
            height: 300px
        }
    </style>
</head>

<body>
    <div class="listCategory" style="display: flex;"></div>
    <br>
    <h1> danh s√°ch book</h1>
    <br>
    <div class="listBook" style="display: flex;"></div>
    <script>
        var listCategory = document.querySelector('.listCategory');
        var listBook = document.querySelector('.listBook');
        renderCategory()
        renderBook()
        function renderCategory() {
            fetch('http://localhost:3000/category/show', {
                method: 'GET'
            })
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    let html = ''
                    for (let i = 0; i < data.length; i++) {
                        html += `<div style="margin: 30px;"><p>${data[i].Name}</p>
                        <a target="_blank" href="">
                            <img src="${data[i].Image}" alt="https://scholastic.asia/sites/all/themes/scholastic_asia/images/default-book.png">
                        </a>
                        </div>`
                    }
                    listCategory.innerHTML = html
                })
        }
        function renderBook() {
            fetch('http://localhost:3000/book/show', {
                method: 'GET'
            })
                .then(response => response.json())
                .then(books => {
                    const promises = books.map(book => (
                        fetch(`http://localhost:3000/image/show/${book.id}`, {
                            method: 'GET'
                        })
                            .then(response => response.json())
                            .then(images => images[0])
                            .then(image => ({
                                book,
                                image
                            }))
                    ));
                    Promise.all(promises)
                        .then(results => {
                            var extra = "https://scholastic.asia/sites/all/themes/scholastic_asia/images/default-book.png"
                            let html = '';
                            results.forEach(result => {
                                const { book, image } = result;

                                html += `<div style="margin: 20px;">
                                            <a href="detail.html?id=${book.id}">
                                                <img class="imageBook" src="${image ? image.Image : extra}" alt="Forest">
                                            </a>
                                            <p>${book.Name}</p>
                                        </div>`;
                            });
                            listBook.innerHTML = html;
                        });
                });
        }
    </script>
</body>

</html>