<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
    </head>
    <body>
        Username: <input type="text" id="username"><br>
        password: <input type="text" id="password"><br>
        <button onclick="login()">login</button>

        <p class="message"></p>
        <script>
        function setCookie(cname, cvalue, exdays) {
            const d = new Date();
            d.setTime(d.getTime() + (exdays*24*60*60*1000));
            let expires = "expires="+ d.toUTCString();
            document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
        }
        function getCookie(cname) {
            let name = cname + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for(let i = 0; i <ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
                }
            }
            return "";
        }
        
        var username = document.querySelector('#username')
        var password = document.querySelector('#password')
        var message = document.querySelector('.message')
        
        login = async()=> {
            let usernameInput = username.value.trim();
            let passwordInput = password.value.trim();
<<<<<<< HEAD
            fetch("http://localhost:5000/api/login",{
=======
            fetch("http://localhost:3000/api/login",{
>>>>>>> master
                method: 'POST',
                headers:{
                    'Content-Type':'application/json',
                },
                body: JSON.stringify({
                    Username: usernameInput,
                    Password:passwordInput
                })
            })
            .then(response=>response.json())
            .then(data=>{
                console.log(data)
                if(data.success === false)
                {
                    message.innerHTML = `${data.message}`
                    message.style.color = 'red'
                }
                else
                {
                    message.innerHTML = `đăng nhập thành công với vai trò ${data.role} `
                    message.style.color = 'green'
                    // setCookie('token',data.token,1)
                    document.cookie = `token=${data.token}`;
                     location.replace("http://127.0.0.1:5500/client-test/account.html")
                }
                
            })
            .catch(err=>{console.log(err)})
        }
        

        
    </script>
    </body>
</html>
